<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.board.mapper.TuserMapper">
	
	<!-- select : getTuserList -->
	<select id="getTuserList" resultType="com.board.domain.TuserDTO">
		SELECT
			userid, passwd, username, email, upoint, DATE_FORMAT(indate, '%Y-%m-%d') AS indate,
		CASE
			WHEN upoint BETWEEN 0 AND 20000 THEN '새싹회원'
			WHEN upoint BETWEEN 20001 AND 50000 THEN '나무회원'
			WHEN upoint BETWEEN 50001 AND 100000 THEN '숲회원'
			WHEN upoint BETWEEN 100001 AND 1000000 THEN '세계수'
			WHEN userid = 'admin' THEN '마스터'
		END AS grade
		FROM
			tuser
	</select>
	
	<!-- select : getTuserMini -->
	<select id="getTuserMini" resultType="com.board.domain.TuserDTO">
		SELECT
			userid, username, email, upoint
		FROM
			tuser
		WHERE
			userid = #{userid} AND
			passwd = #{passwd}
	</select>
	
	<!-- select : getTuserUpdateData -->
	<select id="getTuserUpdateData" resultType="com.board.domain.TuserDTO">
		SELECT
			userid, passwd, username
		FROM
			tuser
		WHERE
			userid = #{userid}
	</select>
	
	<!--  
	select userid, passwd, username, email, upoint, indate,
	case
	   when upoint between 0 and 20000 then '새싹회원'
	   when upoint between 20001 and 50000 then '나무회원'
	   when upoint between 50001 and 100000 then '숲회원'
	   when upoint between 100001 and 1000000 then '세계수'
	   when userid = 'admin' then '마스터'
	end AS grade
	FROM tuser;
	 -->
	
	<!-- select : getTuserMaxi -->
	<select id="getTuserMaxi" resultType="com.board.domain.TuserDTO">
		SELECT
			userid, passwd, username, email, upoint, DATE_FORMAT(indate, '%Y-%m-%d') AS indate
		CASE
			WHEN upoint BETWEEN 0 AND 20000 THEN 새싹회원
			WHEN upoint BETWEEN 20001 AND 50000 THEN 나무회원
			WHEN upoint BETWEEN 50001 AND 100000 THEN 숲회원
			WHEN upoint BETWEEN 100001 AND 1000000 THEN 세계수
			WHEN userid = 'admin' THEN '마스터'
		END AS grade
		FROM
			tuser
		WHERE
			userid = #{userid} AND
			passwd = #{passwd}
	</select>
	
	<!-- select : login -->
	<select id="login" resultType="com.board.domain.TuserDTO">
		SELECT
			userid, passwd
		FROM
			tuser
		WHERE
			userid = #{userid} AND
			passwd = #{passwd}
	</select> 
	
	<!-- insert : insertTuser -->
	<insert id="insertTuser">
		INSERT INTO
			tuser (userid, passwd, username, email, upoint)
		VALUES
			(#{userid}, #{passwd}, #{username}, #{email}, 1000)
	</insert>
	
	<!-- update : updateTuserEmail -->
	<update id="updateTuserEmail">
		UPDATE
			tuser
		SET
			email = #{email}
		WHERE
			userid = #{userid} AND
			passwd = #{passwd}
	</update>
	
	<!-- update : updateTuserPoint -->
	<update id="contentPointUp">
		UPDATE
			tuser
		SET
			upoint = #{upoint}
		WHERE
			userid = #{userid} AND
			passwd = #{passwd}
	</update>
	
	<!-- delete : deleteTuser -->
	<delete id="deleteTuser">
		DELETE FROM tuser
		WHERE userid = #{userid}
	</delete>
	
</mapper>